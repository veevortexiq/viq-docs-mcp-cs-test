# Bitbucket Integration

## Bitbucket Account Setup

### Step 1: Sign up or log in to Bitbucket Account
- Visit Bitbucket's official website, create an account, and log in.

### Step 2: Create Workspace
- Upon logging in, click **Create workspace**.
- Provide the workspace details and proceed.

### Step 3: Create Repository
- Enter **Project Name**
- Enter **Repository Name**
- Set **Access Level**
- **Important:** Always set the default branch name as `main`.

After successfully creating the repository, a URL similar to the following will be generated:

```
https://bitbucket.org/{workspace}/{repository}/src/main/
```

In StagingPro, you must use the format:
```
workspace/repository
```
Example:
```
themedeploy-stagingpro/stagingpro-repo
```

### Step 4: Add User to Bitbucket Workspace and Repository
1. Navigate to the repository and click the **Settings** icon.
2. Go to **User Management** → **Invite**.
3. Invite the following user:
   - **Email:** bitbucket@stagingpro.com
   - **Product Roles:**
     - User
     - Product admin
     - User access admin
4. **Group Permissions:**
   - bitbucket-admins
   - bitbucket-user-access-admins
   - bitbucket-users
   - org-admins

Select:
```
bitbucket-admins-themedeploy-stagingpro
```

5. Click **Invite users**.

For additional users:
- Assign developer permissions.
- Follow similar steps with appropriate access levels.

### Step 5: Verify Repository
1. Log in to **StagingPro**.
2. Navigate to **Settings → Connect Repository**.
3. Enter the repository URL.
4. Click **Verify Bitbucket Account** and grant access.
5. A success message confirms verification.

### Step 6: Add Team Members
1. Click **Add Team Member** in StagingPro.
2. Enter **Bitbucket Username** and **Bitbucket Name**.

To find these:
- Go to: https://bitbucket.org/account/settings/

Example:
- **Bitbucket Name:** Theme Deploy
- **Bitbucket Username:** themedeploy

3. Save and select environment type for branch creation.
4. Confirm selection.

> **IMPORTANT:** Team members added in StagingPro must also have repository access in Bitbucket.

### Step 7: Change Permissions / Environment Type
- Click **Change Permission** to update or remove environment access.

### Step 8: Remove User
- Click **Remove** in StagingPro.
- This removes the user from StagingPro only (not from Bitbucket).

---

## Code Deployment Workflow

### Direct Commit
- View commits under **Code Deployment**.
- Use **Generate Preview and Approve Later** to preview changes.
- Click **Approve and Deploy** to deploy.

### Pull Request Workflow
1. Create a Pull Request in Bitbucket.
2. Navigate to **Pull Requests** → **Create Pull Request**.
3. Select destination environment branch.
4. Add comments and **Approve & Merge**.
5. Do not modify auto-generated commit messages.
6. After merge, preview and deploy via StagingPro.

---

## Maximum Theme Notification
If the maximum theme limit (20) is reached:
- Select themes to delete.
- Confirm and refresh the page.

---

## StagingPro Git Branch Workflow

- Developers commit code to individual branches.
- Environment branches are auto-generated.
- **Do NOT rename or delete auto-generated branches.**

### Branches are created:
- Per environment
- Per channel
- Per team member

---

## Code Deployment Statuses

### Awaiting Approval
Options:
- **Approve and Deploy**
- **Generate Preview and Approve Later**

### Approved
- Status: **Merge Successful | Theme Deployed**
- Rollback option available.

### Errors / Conflicts
- Resolve conflicts (e.g., `config.json`) before retrying.

### Rejected
- Status: **Rejected | Code Not Approved**

---

## Bitbucket FAQs

**Q1. Can autogenerated branches be renamed?**  
No. These branches are required for tracking and must remain unchanged.

**Q2. Purpose of developer branches?**  
They allow developers to commit independently without impacting others.

**Q3. Benefits over feature branches?**  
Yes. Developers can merge safely without conflicts across teams.

**Q4. Role of main/master branch?**  
Acts as a buffer branch. Use autogenerated environment branches instead.

**Q5. Does StagingPro export themes to Bitbucket?**  
Yes. Once connected, themes are automatically downloaded.

**Q6. Do commits appear as rollback options?**  
Yes. All commits are tracked and rollback options are available.

**Q7. CI/CD support?**  
StagingPro supports multi-team workflows with notifications via:
- Email
- Microsoft Teams
- Slack


---

To view our Onboarding steps, please access the following article → [**StagingPro Onboarding**](stagingpro-onboarding/index.md)

---

[← Back to Help Center](../../index.md){ .md-button }